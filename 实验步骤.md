● 好的!我为你整理详细的操作步骤,你可以按照这个清单一步步执行:

  ---
  📋 Mathis 假设验证实验改进 - 执行清单

  ✅ 已完成

  - 生成 10MB 测试文件 (/home/serennan/work/algo2/foggytcp2/testdata/test_10mb.bin)

  ---
  🔧 阶段 1: 环境验证 (在你的终端执行)

  步骤 1.1: 检查网络命名空间

  # 检查命名空间是否存在
  ip netns list
  # 预期输出: ns_server 和 ns_client

  # 如果不存在,运行setup脚本
  cd /home/serennan/work/algo2/foggytcp2/scripts
  sudo ./setup_netns.sh

  步骤 1.2: 验证网络连通性

  # 测试ping连通性
  sudo ip netns exec ns_client ping -c 5 10.0.1.1
  # 预期: 100% 成功,0% packet loss

  步骤 1.3: 测试 tcconfig 是否生效

  # 应用测试配置: 1% 丢包
  sudo ip netns exec ns_client tcset veth_client --rate 10Mbps --delay 50ms --loss 1%

  # 测试丢包率
  sudo ip netns exec ns_client ping -c 100 10.0.1.1 | grep "packet loss"
  # 预期: 显示约 1% 丢包 (0.5%-2% 都正常)

  # 清理测试配置
  sudo ip netns exec ns_client tcdel veth_client --all

  步骤 1.4: 备份旧数据

  cd /home/serennan/work/algo2/foggytcp2/results
  mv mathis_data.csv mathis_data_old_1mb_$(date +%Y%m%d_%H%M).csv

  ---
  📝 阶段 2: 更新实验脚本

  编辑 /home/serennan/work/algo2/foggytcp2/scripts/experiment_mathis.py

  需要修改的配置 (约第 20-40 行):

  # 1. 修改测试文件路径 (约第 37 行)
  TEST_FILE = PROJECT_ROOT / "testdata" / "test_10mb.bin"  # 改为 10MB

  # 2. 修改丢包率列表 (约第 20 行)
  LOSS_RATES = [0.0001, 0.0002, 0.0005, 0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.1]

  # 3. 修改延迟 (约第 23 行)
  DELAY = "50ms"  # RTT = 100ms

  # 4. 修改重复次数 (约第 21 行)
  TRIALS_PER_LOSS = 15

  # 5. 修改超时时间 (约第 24 行)
  TIMEOUT_SECONDS = 600  # 10分钟

  快速修改命令 (可选,或手动编辑):

  cd /home/serennan/work/algo2/foggytcp2/scripts

  # 备份原文件
  cp experiment_mathis.py experiment_mathis.py.backup

  # 使用 sed 批量替换
  sed -i 's|test_1mb.bin|test_10mb.bin|g' experiment_mathis.py
  sed -i 's|DELAY = "20ms"|DELAY = "50ms"|g' experiment_mathis.py
  sed -i 's|TRIALS_PER_LOSS = 10|TRIALS_PER_LOSS = 15|g' experiment_mathis.py
  sed -i 's|TIMEOUT_SECONDS = .*|TIMEOUT_SECONDS = 600|g' experiment_mathis.py
  sed -i 's|LOSS_RATES = \[0.0001.*\]|LOSS_RATES = [0.0001, 0.0002, 0.0005, 0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.1]|g' experiment_mathis.py

  ---
  🚀 阶段 3: 运行实验

  cd /home/serennan/work/algo2/foggytcp2/scripts

  # 运行实验 (预计 3-6 小时)
  python3 experiment_mathis.py

  # 或者在后台运行并记录日志
  nohup python3 experiment_mathis.py > experiment_improved.log 2>&1 &

  # 查看进度
  tail -f experiment_improved.log

  # 或检查数据文件行数
  watch -n 10 'wc -l /home/serennan/work/algo2/foggytcp2/results/mathis_data.csv'

  实验规模:
  - 总次数: 10 丢包率 × 15 次 = 150 次实验
  - 预计时间: 3-6 小时
  - 每次传输: 10-60 秒 (取决于丢包率)

  ---
  📊 阶段 4: 数据分析

  等实验完成后运行:

  cd /home/serennan/work/algo2/foggytcp2/scripts

  # 运行分析脚本
  python3 analyze_mathis.py

  # 查看结果
  cat ../results/mathis_summary.txt
  xdg-open ../results/mathis_plot.png  # 查看图表

  ---
  ✅ 验证标准

  实验成功的标志:
  - ✅ R² > 0.8 (优秀: > 0.9)
  - ✅ Pearson r > 0.85 (优秀: > 0.95)
  - ✅ 常数 C 在 0.5-3.5 范围内
  - ✅ 吞吐量明显随丢包率变化 (不再是恒定的 6.3 Mbps)
  - ✅ 传输时间显著增加 (10-60 秒,不再是 1.3 秒)

  ---
  ⚠️ 常见问题处理

  问题 1: 程序卡住不动
  # Ctrl+C 中止
  # 检查进程
  ps aux | grep -E "(server|client)"
  # 清理残留进程
  sudo pkill -9 server
  sudo pkill -9 client
  # 重新运行实验

  问题 2: 丢包率测试不生效
  # 重新检查 tcconfig 配置
  sudo ip netns exec ns_client tcshow veth_client
  # 应该显示配置的参数

  问题 3: 权限错误
  # 修改 results 目录权限
  sudo chown -R $USER:$USER /home/serennan/work/algo2/foggytcp2/results/

  ---
  📌 总结

  改进要点:
  1. 文件: 1MB → 10MB (传输时间 ×10)
  2. RTT: 40ms → 100ms (丢包影响 ×2.5)
  3. 丢包率: 7个 → 10个测试点
  4. 重复: 10次 → 15次

  预期效果:
  - 吞吐量从恒定 6.3 Mbps → 0.5-4 Mbps (随丢包率变化)
  - R² 从 < 0.3 → > 0.9
  - 验证成功支持 Mathis 假设

  按照这些步骤操作,有任何问题随时告诉我!