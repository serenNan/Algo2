# TCP Reno 实验报告与算法设计

## 第一部分: Dr. Matt Mathis 假设验证

### 假设

Dr. Matt Mathis 假设:TCP Reno 实现遵循以下吞吐量方程:

**throughput = (MSS/RTT) × (C/√p)**

其中:
- C 是一个常数
- p 是丢包概率
- RTT 是往返时间
- MSS 在本项目中为 1400 字节

以下测量将帮助你验证这个假设。

(参考文献: https://dl.acm.org/doi/10.1145/263932.264023)

### 实验

使用 tcconfig 在发送端节点上调整丢包概率 p 到不同的值。

```bash
sudo tcset eth0 --rate 10Mbps --delay 20ms --loss 0.01%
```

对于不同的 p 值,传输一个大文件并测量传输持续时间(确保调整文件大小,使传输至少需要几秒钟)。使用传输持续时间和文件大小计算吞吐量。对每个丢包概率重复相同的实验 10 次。创建一个线性图,x 轴为 1/√p,y 轴为吞吐量。进行线性回归并在同一图上包含回归线。

### 推论

基于实验结果,请回答以下问题:

- 使用线性回归,你找到的 C 值是多少?
- 计算 1/√p 与测量的吞吐量之间的皮尔逊相关系数
- 你的数据是否证实了 Dr. Mathis 的假设?为什么?

### 提示

由于缺少超时重传机制,有时程序可能会卡住,请重试。

---

## 第二部分: 设计你自己的 CCA

现在你有机会设计自己的拥塞控制算法(CCA),目标是超越 TCP Reno 的性能,你可以修改任何你喜欢的内容。

- **评估指标**:吞吐量(通过传输 1MB 文件所需的时间来测量)

### 提示

- **测试链路**: RTT = 200ms,路由器的缓冲区大小无限。但当缓冲区深度超过 N 时,路由器会添加额外的延迟 X ms。

  例如,如果 N = 5 且缓冲区中当前有 10 个数据包,则会为第 6 到第 10 个数据包添加额外的延迟。

### 如何自行测试

**tcconfig:**

你可以使用 tcconfig 模拟链路(带宽、延迟和丢包率)。

```bash
sudo tcset eth0 --rate 10Mbps --delay 20ms --loss 0.01%
```

**突发流量:**

你可以通过在两个虚拟机之间启动另一个文件传输来模拟突发流量。

**重复 ACK:**

你可以在接收端手动发送重复的 ACK 来模拟拥塞场景。

---

## 报告要求

报告应包括两部分:(1) Dr. Matt Mathis 假设验证 (2) 你自己的 CCA 设计。

### Dr. Matt Mathis 假设部分

- 创建一个线性图,x 轴为 1/√p,y 轴为吞吐量
- 进行线性回归并在同一图上包含回归线
- 使用线性回归,你找到的 C 值是多少?
- 计算 1/√p 与测量的吞吐量之间的皮尔逊相关系数
- 你的数据是否证实了 Dr. Mathis 的假设?为什么?

### 你自己的 CCA 部分

在报告中包含一个名为**算法提案**的部分。在本部分中,你应该:

- 提出一个新算法(或对 Reno 的修改)来提高吞吐量
- 提供详细的算法描述,包括为什么新算法相对于 Reno 实现会提高吞吐量

在报告中包含一个名为**算法评估**的部分。在本部分中,你应该:

- 提供比较 Reno 实现和新算法完成 1MB 传输的数据
- 即单个连接传输 1MB 需要多长时间

---

## 测试用例

### 1.1) test_noloss (test_file_transfer.TestCases)
测试:无丢包情况下可靠传输 50KB 文件

### 2.1) test_recv_window_change (test_flow_control.TestCases)
流控制测试 - 此测试检查发送方是否正确响应接收方通告窗口的变化

### 3.1) test_retransmission_after_three_dupacks (test_dupack.TestCases)
重复 ACK 测试 - 此测试检查在收到 3 个重复 ACK 后数据包是否重传

### 4.1) test_slow_start (test_congestion_control.TestCases)
拥塞控制测试 - 此测试检查慢启动期间拥塞窗口是否指数增长

### 4.2) test_loss_response (test_congestion_control.TestCases)
拥塞控制测试 - 此测试检查拥塞窗口是否响应丢包而减小

### 5.1) test_source_structure (test_submission_files.TestCases)
源代码结构测试
